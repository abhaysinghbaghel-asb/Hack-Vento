<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>404 Thinkers | Upside Down Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- STRANGER THINGS CLICK ANIMATION --- */
        .st-ripple {
            position: fixed; width: 20px; height: 20px; border-radius: 50%;
            background: transparent; border: 2px solid rgba(255, 59, 59, 0.8);
            box-shadow: 0 0 10px #ff3b3b, 0 0 20px #ff3b3b, inset 0 0 10px #ff3b3b;
            transform: translate(-50%, -50%) scale(0); pointer-events: none; z-index: 9999;
            animation: rippleEffect 0.6s ease-out forwards;
        }
        @keyframes rippleEffect {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; border-width: 5px; }
            100% { transform: translate(-50%, -50%) scale(4); opacity: 0; border-width: 0px; }
        }
        .st-spore {
            position: fixed; width: 4px; height: 4px; background-color: #e5e5e5; border-radius: 50%;
            pointer-events: none; z-index: 9998; box-shadow: 0 0 4px rgba(255, 255, 255, 0.8);
            animation: sporeFloat 0.8s ease-out forwards;
        }
        @keyframes sporeFloat {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(0); opacity: 0; }
        }

        /* --- General Reset & Aesthetics --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: #050505; color: #e0e0e0;
            font-family: 'Patrick Hand', cursive; font-size: 19px; padding-bottom: 60px;
            overflow-x: hidden; transition: filter 0.5s ease;
        }

        /* Utilities */
        .text-red { color: #ff0f0f; }
        .text-blue { color: #0f8fff; }
        .text-purple { color: #a80fff; }
        .text-muted { color: #666; }
        .icon-spacer { margin-right: 10px; }

        /* --- Navigation --- */
        nav {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 40px; background: #0a0a0a; border-bottom: 2px solid #1a1a1a;
            box-shadow: 0 4px 20px rgba(0,0,0,0.8); position: relative; z-index: 100;
        }
        .logo-text {
            font-size: 1.8rem; color: #ff0f0f; letter-spacing: 1px;
            text-shadow: 0 0 8px rgba(255, 15, 15, 0.6); font-weight: bold;
        }
        .rift-toggle {
            background: #1a1a1a; color: #ff0f0f; border: 1px solid #ff0f0f;
            padding: 8px 16px; border-radius: 20px; cursor: pointer;
            font-family: inherit; font-size: 1.1rem; transition: 0.3s;
        }
        .rift-toggle:hover { background: #ff0f0f; color: #000; box-shadow: 0 0 15px #ff0f0f; }

        /* --- Layout --- */
        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; position: relative; z-index: 10; }

        /* --- Header --- */
        header { margin-bottom: 50px; }
        .neon-title {
            font-size: 4.5rem; color: #ff0f0f;
            text-shadow: 0 0 5px #ff0f0f, 0 0 15px #ff0f0f, 0 0 30px #ba0000;
            letter-spacing: 2px; line-height: 1;
        }
        .subtitle { color: #999; font-size: 1.4rem; margin-top: 10px; letter-spacing: 1px; }

        /* --- Section Styling --- */
        .section-container {
            margin-bottom: 40px; background: #0c0c0c; padding: 30px;
            border-radius: 16px; border: 1px solid #222;
            box-shadow: 0 5px 25px rgba(0,0,0,0.6);
        }
        .section-header { font-size: 2rem; margin-bottom: 25px; display: flex; align-items: center; justify-content: space-between; }

        /* --- Stats Grid --- */
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 25px; margin-bottom: 50px; }
        .stat-card {
            background: #111; padding: 30px 20px; border-radius: 16px; text-align: center;
            border: 1px solid #222; transition: transform 0.3s, border-color 0.3s, box-shadow 0.3s;
        }
        .stat-card:hover { transform: translateY(-8px); border-color: #ff0f0f; box-shadow: 0 0 20px rgba(255, 15, 15, 0.15); }
        .stat-icon { font-size: 2.2rem; margin-bottom: 15px; }
        .stat-number { font-size: 2.8rem; font-weight: bold; margin-bottom: 5px; line-height: 1; }
        .stat-label { color: #888; font-size: 1.1rem; }

        /* --- Badges & Filters --- */
        .filter-controls { display: flex; gap: 10px; flex-wrap: wrap; }
        .filter-btn {
            background: transparent; border: 1px solid #333; color: #666;
            padding: 5px 15px; border-radius: 15px; cursor: pointer;
            font-family: inherit; font-size: 1rem; transition: 0.2s;
        }
        .filter-btn:hover, .filter-btn.active { border-color: #ff0f0f; color: #fff; }
        .filter-btn.active { background: rgba(255, 15, 15, 0.1); }

        .badges-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 25px; }
        .badge-card {
            background: #161616; border: 1px solid #333; border-radius: 14px; padding: 30px 20px;
            text-align: center; position: relative; transition: transform 0.2s;
        }
        .badge-card:hover { transform: scale(1.02); }
        .badge-main-icon { font-size: 2.5rem; margin-bottom: 15px; }
        .badge-title { font-size: 1.3rem; margin-bottom: 8px; font-weight: bold; }
        .badge-desc { font-size: 1rem; color: #777; margin-bottom: 15px; line-height: 1.3; }
        .rarity-tag { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1.5px; font-weight: bold; }
        
        .glow-rare { border-color: #0f8fff; box-shadow: inset 0 0 15px rgba(15, 143, 255, 0.15); }
        .glow-epic { border-color: #a80fff; box-shadow: inset 0 0 15px rgba(168, 15, 255, 0.15); }
        .glow-legendary { border-color: #ff0f0f; box-shadow: inset 0 0 15px rgba(255, 15, 15, 0.15); }

        .locked-grid .badge-card { opacity: 0.6; border-color: #2a2a2a; background: #0f0f0f; cursor: not-allowed; }
        .lock-overlay { position: absolute; top: 15px; right: 15px; color: #444; font-size: 1.2rem; }

        /* --- Bottom Split & Leaderboard --- */
        .bottom-split { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .panel-container { background: #0d0d0d; padding: 30px; border-radius: 16px; border: 1px solid #222; }

        /* Leaderboard */
        .leaderboard-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 12px; border-bottom: 1px solid #222; transition: 0.2s;
        }
        .leaderboard-item:hover { background: #1a1a1a; }
        .rank { font-weight: bold; width: 30px; color: #666; }
        .lb-user { flex-grow: 1; display: flex; align-items: center; gap: 10px; }
        .lb-avatar { width: 30px; height: 30px; background: #333; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }
        .lb-score { font-weight: bold; color: #ff0f0f; }
        .is-me { background: rgba(255, 15, 15, 0.05); border-left: 3px solid #ff0f0f; }

        /* Milestones & Certs */
        .milestone-item { margin-bottom: 30px; }
        .ms-info { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 1.2rem;}
        .ms-desc { font-size: 1rem; color: #666; margin-bottom: 10px; }
        .progress-track { width: 100%; height: 10px; background: #222; border-radius: 5px; overflow: hidden; }
        .progress-bar { height: 100%; border-radius: 5px; position: relative; }
        .bar-red { background: #ff0f0f; } 
        .bar-blue { background: #0f8fff; }
        .bar-green { background: #0fff50; }

        .cert-item {
            display: flex; justify-content: space-between; align-items: center;
            background: #1a1a1a; padding: 20px; border-radius: 12px; margin-bottom: 15px;
            border: 1px solid #2a2a2a; transition: border-color 0.2s;
        }
        .cert-item:hover { border-color: #444; }
        .cert-title { font-size: 1.2rem; font-weight: bold; }
        .cert-date { font-size: 1rem; color: #666; margin-top: 4px; }
        .grade-circle {
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255, 15, 15, 0.05); border: 2px solid #ff0f0f;
            display: flex; justify-content: center; align-items: center;
            font-size: 1.4rem; color: #ff0f0f; text-shadow: 0 0 5px #ff0f0f; font-weight: bold;
        }

        .cloud-archive-btn {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            width: 100%; padding: 15px; margin-top: 20px;
            background: rgba(255, 15, 15, 0.05); border: 2px dashed #ff0f0f;
            color: #ff0f0f; text-decoration: none; border-radius: 12px;
            font-size: 1.2rem; transition: all 0.3s ease; cursor: pointer;
        }
        .cloud-archive-btn:hover {
            background: rgba(255, 15, 15, 0.15); box-shadow: 0 0 15px rgba(255, 15, 15, 0.3);
            transform: translateY(-2px); border-style: solid;
        }

        /* --- TOAST NOTIFICATION --- */
        .toast {
            position: fixed; bottom: 30px; right: 30px;
            background: #111; border-left: 4px solid #ff0f0f; padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.8); border-radius: 8px;
            display: flex; align-items: center; gap: 15px;
            transform: translateY(100px); opacity: 0; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1000;
        }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast-title { font-weight: bold; font-size: 1.1rem; color: #fff; }
        .toast-msg { color: #888; font-size: 0.9rem; }

        /* --- ATMOSPHERIC FOG (For Rift Mode) --- */
        .fog-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none; opacity: 0; transition: opacity 2s;
            background: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.8) 100%);
        }
        .rift-active .fog-container { opacity: 1; }
        .rift-particle {
            position: absolute; background: rgba(255,255,255,0.8);
            width: 3px; height: 3px; border-radius: 50%;
            animation: floatAsh 10s linear infinite;
        }
        @keyframes floatAsh {
            0% { transform: translateY(100vh) translateX(0); opacity: 0; }
            50% { opacity: 0.8; }
            100% { transform: translateY(-10vh) translateX(20px); opacity: 0; }
        }

        @media (max-width: 900px) {
            .stats-grid, .badges-grid { grid-template-columns: repeat(2, 1fr); }
            .bottom-split { grid-template-columns: 1fr; }
            .neon-title { font-size: 3rem; }
        }
    </style>
</head>
<body>

    <div class="fog-container" id="fog-layer"></div>

    <main class="container">
        <header>
            <h1 class="neon-title">Achievements</h1>
            <p class="subtitle">Your trophies from the Upside Down</p>
        </header>

        <section class="stats-grid" id="top-stats"></section>

        <section class="section-container">
            <div class="section-header">
                <span><i class="fas fa-medal text-red icon-spacer"></i> Badges (Earned)</span>
                <div class="filter-controls" id="badge-filters">
                    <button class="filter-btn active" onclick="filterBadges('All')">All</button>
                    <button class="filter-btn" onclick="filterBadges('Common')">Common</button>
                    <button class="filter-btn" onclick="filterBadges('Rare')">Rare</button>
                    <button class="filter-btn" onclick="filterBadges('Epic')">Epic</button>
                </div>
            </div>
            <div class="badges-grid" id="earned-badges-list"></div>
        </section>

        <section class="section-container">
            <h2 class="section-header"><i class="fas fa-trophy text-blue icon-spacer"></i> Hawkins Leaderboard</h2>
            <div id="leaderboard-list">
                </div>
        </section>

        <section class="section-container">
            <h2 class="section-header text-muted"><i class="fas fa-lock icon-spacer"></i> Locked Badges</h2>
            <div class="badges-grid locked-grid" id="locked-badges-list"></div>
        </section>

        <div class="bottom-split">
            <section class="panel-container">
                 <h2 class="section-header"><i class="fas fa-bullseye text-red icon-spacer"></i> Milestones</h2>
                 <div class="milestones-list" id="milestones-list"></div>
            </section>

            <section class="panel-container">
                <h2 class="section-header"><i class="fas fa-certificate text-red icon-spacer"></i> Certificates</h2>
                <div class="certs-list" id="certs-list"></div>

                <a href="#" class="cloud-archive-btn">
                    <i class="fab fa-google-drive"></i> View All in Cloud Storage
                </a>
            </section>
        </div>
    </main>

    <div class="toast" id="toast">
        <i class="fas fa-info-circle fa-2x text-red"></i>
        <div>
            <div class="toast-title">Locked Badge</div>
            <div class="toast-msg" id="toast-message">Complete more tasks to unlock this mystery!</div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- CUSTOM LOGIC: Persistent Score (Start 0, +5 per open) ---
        // We look for a saved score in LocalStorage. If not found (null), it starts at 0.
        // We then immediately add 5 and save it back.
        let savedScore = localStorage.getItem('upsideDownScore');
        let currentScore = savedScore ? parseInt(savedScore) : 0;
        
        currentScore += 5; // Increase by 5 every time code runs (page reopens)
        localStorage.setItem('upsideDownScore', currentScore);

        // --- CUSTOM LOGIC: Classmate Leaderboard ---
        // I've assigned static "high scores" to your classmates so you can climb past them over time.
        // Deepal (250), Abhay (200), Palak (150), Mahi (100), Twinkle (50).
        // Since you gain +5 per refresh, you will need to refresh ~50 times to beat Deepal!
        
        const mockData = {
            stats: { totalScore: currentScore, badgesEarned: 4, totalBadges: 8, milestonesDone: 3, totalMilestones: 5, certificates: 3 },
            earnedBadges: [
                { title: "7 Day Streak", desc: "Study 7 days in a row", rarity: "Common", icon: "fa-fire", colorClass: "text-muted" },
                { title: "Quiz Master", desc: "Score 100% on 5 quizzes", rarity: "Rare", icon: "fa-star", colorClass: "text-blue glow-rare" },
                { title: "Task Crusher", desc: "Complete 50 tasks", rarity: "Common", icon: "fa-bullseye", colorClass: "text-muted" },
                { title: "Subject Expert", desc: "Master a subject", rarity: "Epic", icon: "fa-book-open", colorClass: "text-purple glow-epic" }
            ],
            lockedBadges: [
                { title: "Night Owl", desc: "Study past midnight", rarity: "Common", icon: "fa-clock" },
                { title: "Speed Demon", desc: "Complete quiz in under 2 mins", rarity: "Rare", icon: "fa-bolt", colorClass: "text-blue" },
                { title: "Champion", desc: "Reach top 10 leaderboard", rarity: "Legendary", icon: "fa-trophy", colorClass: "text-red glow-legendary" },
                { title: "Perfectionist", desc: "100% accuracy for a week", rarity: "Epic", icon: "fa-ribbon", colorClass: "text-purple" }
            ],
            milestones: [
                { title: "First Steps", desc: "Complete your first task", current: 1, target: 1, barColor: "bar-green" },
                { title: "Getting Started", desc: "Study for 10 hours", current: 10, target: 10, barColor: "bar-green" },
                { title: "On a Roll", desc: "Complete 25 tasks", current: 25, target: 25, barColor: "bar-green" },
                { title: "Dedicated Learner", desc: "Study for 50 hours", current: 42, target: 50, barColor: "bar-blue" }
            ],
            certificates: [
                { title: "Mathematics Fundamentals", date: "Dec 15, 2024", grade: "A+" },
                { title: "Physics Basics", date: "Dec 10, 2024", grade: "A" },
                { title: "Chemistry Introduction", date: "Dec 5, 2024", grade: "A+" }
            ],
            leaderboard: [
                { name: "Deepal", score: 250 },
                { name: "Abhay", score: 200 },
                { name: "Palak", score: 150 },
                { name: "Demo User (You)", score: currentScore, isMe: true }, // Your dynamic score
                { name: "Mahi", score: 100 },
                { name: "Twinkle", score: 50 }
            ]
        };

        // Automatically sort leaderboard by score (Highest to Lowest)
        mockData.leaderboard.sort((a, b) => b.score - a.score);

        // --- Core Rendering Functions ---
        function renderStats(stats) {
            document.getElementById('top-stats').innerHTML = `
                <div class="stat-card"><i class="fas fa-trophy stat-icon text-red"></i><div class="stat-number">${stats.totalScore.toLocaleString()}</div><div class="stat-label">Total Score</div></div>
                <div class="stat-card"><i class="fas fa-medal stat-icon text-blue"></i><div class="stat-number">${stats.badgesEarned}/${stats.totalBadges}</div><div class="stat-label">Badges Earned</div></div>
                <div class="stat-card"><i class="fas fa-bullseye stat-icon text-purple"></i><div class="stat-number">${stats.milestonesDone}/${stats.totalMilestones}</div><div class="stat-label">Milestones</div></div>
                <div class="stat-card"><i class="fas fa-certificate stat-icon text-red"></i><div class="stat-number">${stats.certificates}</div><div class="stat-label">Certificates</div></div>
            `;
        }

        // Modified render badges to support filtering
        window.currentBadges = []; // Store for filtering
        function renderBadges(listId, badges, isLocked = false) {
            if(!isLocked) window.currentBadges = badges;
            
            const container = document.getElementById(listId);
            container.innerHTML = badges.map((badge, index) => `
                <div class="badge-card ${badge.colorClass || ''}" ${isLocked ? `onclick="showLockedToast('${badge.title}')"` : ''}>
                    ${isLocked ? '<i class="fas fa-lock lock-overlay"></i>' : ''}
                    <i class="fas ${badge.icon} badge-main-icon ${badge.colorClass ? badge.colorClass.split(' ')[0] : 'text-muted'}"></i>
                    <div class="badge-title">${badge.title}</div>
                    <div class="badge-desc">${badge.desc}</div>
                    <div class="rarity-tag ${badge.colorClass ? badge.colorClass.split(' ')[0] : 'text-muted'}">${badge.rarity}</div>
                </div>
            `).join('');
        }

        function renderLeaderboard(users) {
            const list = document.getElementById('leaderboard-list');
            list.innerHTML = users.map((u, i) => `
                <div class="leaderboard-item ${u.isMe ? 'is-me' : ''}">
                    <div class="rank">#${i+1}</div>
                    <div class="lb-user">
                        <div class="lb-avatar">${u.name.charAt(0)}</div>
                        <span>${u.name}</span>
                        ${u.isMe ? '<i class="fas fa-user text-muted" style="font-size:0.8rem"></i>' : ''}
                    </div>
                    <div class="lb-score">${u.score.toLocaleString()} XP</div>
                </div>
            `).join('');
        }

        function renderMilestones(milestones) {
            document.getElementById('milestones-list').innerHTML = milestones.map(ms => `
                <div class="milestone-item">
                    <div class="ms-info"><strong>${ms.title}</strong><span>${ms.current}/${ms.target}</span></div>
                    <div class="ms-desc">${ms.desc}</div>
                    <div class="progress-track"><div class="progress-bar ${ms.barColor}" style="width: ${(ms.current / ms.target) * 100}%"></div></div>
                </div>
            `).join('');
        }

        function renderCertificates(certs) {
            document.getElementById('certs-list').innerHTML = certs.map(cert => `
                <div class="cert-item"><div><div class="cert-title">${cert.title}</div><div class="cert-date">${cert.date}</div></div><div class="grade-circle">${cert.grade}</div></div>
            `).join('');
        }

        // --- New Interaction Functions ---

        // 1. Badge Filtering
        window.filterBadges = (rarity) => {
            // Update active button state
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Filter logic
            const filtered = rarity === 'All' 
                ? mockData.earnedBadges 
                : mockData.earnedBadges.filter(b => b.rarity === rarity);
            
            // Re-render
            const container = document.getElementById('earned-badges-list');
            container.innerHTML = filtered.map(badge => `
                <div class="badge-card ${badge.colorClass || ''}">
                    <i class="fas ${badge.icon} badge-main-icon ${badge.colorClass ? badge.colorClass.split(' ')[0] : 'text-muted'}"></i>
                    <div class="badge-title">${badge.title}</div>
                    <div class="badge-desc">${badge.desc}</div>
                    <div class="rarity-tag ${badge.colorClass ? badge.colorClass.split(' ')[0] : 'text-muted'}">${badge.rarity}</div>
                </div>
            `).join('');
            
            if(filtered.length === 0) container.innerHTML = '<div style="grid-column:1/-1; text-align:center; color:#666; padding:20px;">No badges found for this rarity.</div>';
        };

        // 2. Rift Mode (Visual Toggle)
        window.toggleRift = () => {
            document.body.classList.toggle('rift-active');
            const fog = document.getElementById('fog-layer');
            
            if(document.body.classList.contains('rift-active')) {
                // Generate particles
                for(let i=0; i<30; i++) {
                    const part = document.createElement('div');
                    part.className = 'rift-particle';
                    part.style.left = Math.random() * 100 + 'vw';
                    part.style.animationDuration = (Math.random() * 5 + 5) + 's';
                    part.style.animationDelay = (Math.random() * 5) + 's';
                    fog.appendChild(part);
                }
            } else {
                fog.innerHTML = ''; // Clear particles
            }
        };

        // 3. Toast Notification
        window.showLockedToast = (badgeName) => {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = `Keep studying to unlock: ${badgeName}`;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        };

        // --- Initialization ---
        function initDashboard() {
            renderStats(mockData.stats);
            renderBadges('earned-badges-list', mockData.earnedBadges);
            renderBadges('locked-badges-list', mockData.lockedBadges, true);
            renderLeaderboard(mockData.leaderboard);
            renderMilestones(mockData.milestones);
            renderCertificates(mockData.certificates);
        }
        document.addEventListener('DOMContentLoaded', initDashboard);

        // --- Click Animation Logic (Preserved) ---
        document.addEventListener('click', (e) => {
            const x = e.clientX;
            const y = e.clientY;
            const ripple = document.createElement('div'); 
            ripple.className = 'st-ripple';
            ripple.style.left = `${x}px`; ripple.style.top = `${y}px`;
            document.body.appendChild(ripple);
            for(let i = 0; i < 8; i++){
                const spore = document.createElement('div'); 
                spore.className = 'st-spore';
                spore.style.left = `${x}px`; spore.style.top = `${y}px`;
                spore.style.setProperty('--dx', `${(Math.random() - 0.5) * 150}px`);
                spore.style.setProperty('--dy', `${(Math.random() - 0.5) * 150}px`);
                document.body.appendChild(spore); 
                setTimeout(() => spore.remove(), 800);
            }
            setTimeout(() => ripple.remove(), 600);
        });
    </script>
</body>
</html>
